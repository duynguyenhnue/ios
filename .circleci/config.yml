version: 2.1

jobs:
  build:
    macos:
      xcode: "12.4.0"  # Chọn phiên bản Xcode phù hợp
    resource_class: macos.medium   # Đảm bảo sử dụng tài nguyên hợp lệ
    steps:
      - checkout
      - run:
          name: Install Node.js
          command: |
            brew install nvm
            export NVM_DIR="$HOME/.nvm"
            [ -s "$(brew --prefix nvm)/nvm.sh" ] && \. "$(brew --prefix nvm)/nvm.sh"
            nvm install 14
            nvm use 14
      - run:
          name: Install Yarn
          command: npm install -g yarn
      - run:
          name: Install dependencies
          command: yarn install
      - run:
          name: Install CocoaPods
          command: |
            cd ios
            pod install
      - run:
          name: Build and test
          command: |
            cd ios
            xcodebuild -workspace YourProject.xcworkspace -scheme YourScheme -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone 12,OS=14.4' clean build test

workflows:
  version: 2
  build_and_test:
    jobs:
      - build
